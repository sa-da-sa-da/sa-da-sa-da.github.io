---
title: 我创建了一个考务助手
date: 2025-03-06 17:24:35
permalink: /teach/yw/assistant/
titleTag: 推荐
categories:
  - 学习
tags:
  - 学习
coverImg: >-
  https://cdn-hsyq-static-bak.shanhutech.cn/bizhi/staticwp/201802/59f08e7bd89c79186b6c73c320d09268.jpg
---

## 一、功能：
```
⭐本地时间显示：网站首页显著位置呈现设备的本地时间，其精准度依托本地系统与先进网络同步保障。

这一功能不仅为师生提供统一时间参照，更在考务场景中发挥关键作用。

如限时练、正式考试等环节，确保全体人员时间认知一致，规避因时间差异引发的考试流程错乱，维护考试公正性与严肃性。

⭐限时练安排发布：为各年级提供统一的限时练考试时间安排平台，便于教师、学生及家长及时了解教学进度中的测验计划。例如，教师可依据此安排提前备课、准备试卷；

学生能合理规划学习节奏，进行针对性复习；家长则可从旁协助学生调整状态、监督学习进度。

⭐通知考务人员：作为考务信息发布核心渠道，监考老师可实时反馈考场内常见的问题

（如，答题卡更换/缺失等关键问题，Webhook可向钉钉群机器人、企业微信群机器人、微信公众号等实时推送消息。

⭐通知考场师生：借由公告栏、弹窗提醒二元组合，确保信息即时（实时）触达考生、监考员。

极大压缩信息传递周期，提升考务执行效率，有效降低因信息延误或错漏引发的考务风险，为考试组织管理注入强劲动力。

⭐优化用户体验：
- 配有两种主题色：黑色和白色
- 配有全屏、打开公告栏、通知考务、切换主题按钮，一触即达对应需求场景。
- 配置简单，操作方便，安全，几乎免费。

```
<ins id="a1"></ins>
## 二、准备

📆1. 开通阿里云函数计算，其他服务器类型均可，本文以函数计算为例
📆2. 开通GoEasy，实现消息推送
📆3. 拥有Wps/金山文档 账号、钉钉群或企业微信群
📆4. 拥有一个备案域名或者域名（需要解析到大陆以外地区（非必需，如果是服务器可以是ip地址）

## 三、搭建步骤

1. 登录 金山文档。打开goeasy官网。打开阿里云函数计算控制台。
![1](https://qiniu.sakaay.com/articlePicture/Sakaay11733316318732583.png)
2. goeasy ，创建应用（免费的基础版就行），进入 详情后复制`应用名`、`Common key`、复制`Client key` 和`Secret key`（后两个备用）


3. 打开https://kdocs.cn/l/cdAt4cAjGC8f另存为副本，打开Airscript脚本编辑器，在脚本获取公告数据推送 填入 Common key、应用名到对应位置。
![2](https://qiniu.sakaay.com/articlePicture/Sakaay11733316469592564.png)

```javascript
const sheet = Application.Sheets('发布公告');
const goEasykey = ""  // 填入 你的实际 appkey
const appname = ""    // 填入 你的实际 appkey 的名称
……
```


4. 授权服务、获取hqsj和获取公告数据推送 的 webhook地址。


![3](https://qiniu.sakaay.com/articlePicture/Sakaay11733317207715151.png)

![4](https://qiniu.sakaay.com/articlePicture/Sakaay11733317264208648.png)


5. 阿里云函数计算（帮助文档），创建web函数，选择0.1cpu和128MB内存就够用了，编辑如下环境变量。然后上传代码包。绑定对应域名。

|变量|值|
|-|-|
|kdocsToken|wps脚本令牌|
|kdocsUrl|表单脚本（hqsj）的webhook|
|Secretkey|从goeast中获取|

如果有备案域名，选择国内服务区，没有备案域名，选择港区


6. 打开呼叫考务表单，创建副本，在自己的副本表单页面关联工作表。创建自动化流程，找到钉钉群通知或企业微信群通知，然后填入下一步的webhook地址。


7. 打开企微群添加机器人，将获得webhook地址，在表单自动化流程中填入webhook地址


8. 复制 呼叫考务表单 地址，打开函数计算的函数页面，点击对应的函数， 打开代码开发页面，修改以下变量的值。打开编辑器的 terminal  ，执行以下命令:


```javascript
npm install crypto
```






|路径|对应的变量|值|
|-|-|-|
|/code/public/js/button.js| |呼叫考务的表单地址|
|/code/public/js/ms.js| appkey | goeasy 对应的 Client key|








